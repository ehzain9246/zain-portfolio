"function"!=typeof Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e}),function(t,e,a,o){t.fn.socialfeed=function(e){var a=t.extend({plugin_folder:"",template:"template.html",show_media:!1,readMore:"Read More Â»",media_min_width:300,length:500,date_format:"ll",date_locale:"en",adminPosts:!1,totalPostsNumber:null,messagedPosts:0,adminPostsNumber:0,since:{years:" years ago",months:" months ago",weeks:" weeks ago",minutes:" minutes ago",seconds:" seconds ago"}},e),n=t(this),i=["facebook","twitter"],r=0,s=0;i.forEach(function(t){a[t]&&(a[t].accounts?r+=a[t].limit*a[t].accounts.length:a[t].urls?r+=a[t].limit*a[t].urls.length:r+=a[t].limit)});var c={request:function(e,a){t.ajax({url:e,dataType:"jsonp",success:a})},get_request:function(e,a){t.get(e,a,"json")},wrapLinks:function(t,e){return t.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,c.wrapLinkTemplate)},wrapLinkTemplate:function(t){return'<a target="_blank" href="'+t+'">'+t+"</a>"},shorten:function(e){return(e=t.trim(e)).length>a.length?jQuery.trim(e).substring(0,a.length).split(" ").slice(0,-1).join(" ")+"...":e},stripHTML:function(t){return null==t?"":t.replace(/(<([^>]+)>)|nbsp;|\s{2,}|/gi,"")}};function u(t,e){this.content=e,this.content.social_network=t,this.content.attachment=this.content.attachment===o?"":this.content.attachment,this.content.time_ago=e.dt_create,this.content.dt_create=this.content.dt_create.valueOf(),this.content.text=c.wrapLinks(c.shorten(e.message+" "+e.description),e.social_network),this.content.moderation_passed=!a.moderation||a.moderation(this.content),l[t].posts.push(this)}u.prototype={render:function(){var e=l.template(this.content),o=this.content;if(0!==t(n).children("[social-feed-id="+o.id+"]").length)return!1;if(0===t(n).children().length)t(n).append(e);else{var i=-1;if(this.content.social_network,t.each(t(n).children(),function(){}),t(n).append(e),i>=0){i++;var c=t(n).children("div:nth-child("+i+")"),u=t(n).children("div:last-child");t(u).insertBefore(c)}}if(a.media_min_width){var d="[social-feed-id="+o.id+"] img.attachment",m=t(d),f=new Image,h=m.attr("src");t(f).on("load",function(){f.width<a.media_min_width&&m.hide(),delete f}).on("error",function(){m.hide()}).attr({src:h})}a.totalPostsNumber&&(r=a.messagedPosts),++s==(a.adminPosts?a.adminPostsNumber:r)&&a.callback&&a.callback()}};var l={template:!1,init:function(){l.getTemplate(function(){i.forEach(function(t){a[t]&&(a[t].accounts?a[t].accounts.forEach(function(e){l[t].getData(e)}):a[t].urls?a[t].urls.forEach(function(e){l[t].getData(e)}):l[t].getData())})})},getTimeAgo:function(t,e){var o=0;"fb"===e&&(t=t.replace(/-/g,"/").replace("T"," ").split("+")[0],o=60*new Date(t).getTimezoneOffset()*1e3);var n=Date.now()-new Date(t).getTime()+o;return n<6e4?1<(n=Math.round(n/1e3))?n+" seconds ago":n+" second ago":n<36e5?1<(n=Math.round(n/6e4))?n+" minutes ago":n+" minute ago":n<864e5?1<(n=Math.round(n/36e5))?n+" hours ago":n+" hour ago":n<2592e6?1<(n=Math.round(n/864e5))?n+" days ago":n+" day ago":n<31536e6?1<(n=Math.round(n/2592e6))?n+a.since.months:n+" month ago":1<(n=Math.round(n/31536e6))?n+a.since.years:n+" year ago"},getTemplate:function(e){return l.template?e():a.template_html?(l.template=doT.template(a.template_html),e()):void t.get(a.template,function(t){return l.template=doT.template(t),e()})},twitter:{posts:[],loaded:!1,api:"https://api.twitter.com/1.1/statuses/user_timeline.json",getData:function(t){var e=new Codebird;switch(e.setToken(a.twitter.token,a.twitter.secret)||e.setConsumerKey(a.twitter.consumer_key,a.twitter.consumer_secret),a.twitter.proxy!==o&&e.setProxy(a.twitter.proxy),t[0]){case"@":var n=t.substr(1);e.__call("statuses_userTimeline",{id:n,count:a.twitter.limit,tweet_mode:void 0===a.twitter.tweet_mode?"compatibility":a.twitter.tweet_mode},l.twitter.utility.getPosts,!0);break;case"#":e.__call("search_tweets",{q:t,count:a.twitter.limit,tweet_mode:void 0===a.twitter.tweet_mode?"compatibility":a.twitter.tweet_mode},function(t){jQuery.ajax({url:l.twitter.utility.getPosts(t.statuses)}).done(function(){a.callback()})},!0)}},utility:{getPosts:function(e){var a=1;e&&t.each(e,function(){new u("twitter",l.twitter.utility.unifyPostData(this,a)).render(),a+=a})},unifyPostData:function(t,e){var o={};function n(t,e){return e=e||0,Math.floor(t*Math.pow(10,e))/Math.pow(10,e)}function i(t){return t>=1e9?n(t/1e9,1)+"G":t>=1e6?n(t/1e6,1)+"M":t>=1e4?n(t/1e3,1)+"K":t}if(t.id&&(o.counter=e,o.id=t.id_str,o.screen_name=t.user.screen_name,o.retweet_count=t.retweet_count,o.favorite_count=t.favorite_count,o.showHeader="yes"===a.twitter.header,o.dt_create=l.getTimeAgo(t.created_at,"twitter"),o.author_link="https://twitter.com/"+t.user.screen_name,o.author_picture=t.user.profile_image_url_https,o.author_picture_hq=o.author_picture.replace("_normal",""),o.cover_picture=t.user.profile_banner_url,o.readMore=a.readMore,o.post_url=o.author_link+"/status/"+t.id_str,o.author_name=t.user.name,o.message=void 0===t.text?t.full_text:t.text,o.description="",o.link="https://twitter.com/"+t.user.screen_name+"/status/"+t.id_str,o.followers_count=i(t.user.followers_count),o.following_count=i(t.user.friends_count),o.tweets_count=i(t.user.statuses_count),!0===a.show_media&&t.entities.media&&t.entities.media.length>0)){var r=t.entities.media[0].media_url_https;r&&(o.attachment='<img class="attachment" src="'+r+'" />')}return o}}},facebook:{posts:[],graph:"https://graph.facebook.com/",loaded:!1,getData:function(t){if(a.facebook.feedObject)l.facebook.utility.getPosts(a.facebook.feedObject);else{var e=function(t){c.request(t,l.facebook.utility.getPosts)},o="?fields=id,from,message,created_time,admin_creator,story";o+=!0===a.show_media?",full_picture":"";var n,i="&limit="+a.facebook.limit,r="&access_token="+a.facebook.access_token+"&callback=?";switch(t[0]){case"@":var s=t.substr(1);l.facebook.utility.getUserId(s,function(t){""!==t.id&&(n=l.facebook.graph+"v5.0/"+t.id+"/posts"+o+i+r,e(n))});break;case"!":var u=t.substr(1);n=l.facebook.graph+"v5.0/"+u+"/feed"+o+i+r,e(n);break;default:e(n)}}},utility:{getUserId:function(e,o){var n="https://graph.facebook.com/"+e+"?&access_token="+a.facebook.access_token+"&callback=?";t.get(n,o,"json")},prepareAttachment:function(t){var e=t.full_picture;return-1!==e.indexOf("_b.")||(-1!==e.indexOf("safe_image.php")?e=l.facebook.utility.getExternalImageURL(e,"url"):-1!==e.indexOf("app_full_proxy.php")?e=l.facebook.utility.getExternalImageURL(e,"src"):t.object_id&&(e=l.facebook.graph+t.object_id+"/picture/?type=normal")),'<img class="attachment" src="'+e+'" />'},getExternalImageURL:function(t,e){return-1===(t=decodeURIComponent(t).split(e+"=")[1]).indexOf("fbcdn-sphotos")?t.split("&")[0]:t},getPosts:function(t){var e=a.adminPosts;t.data&&(a.totalPostsNumber=t.data.length),t.data&&t.data.forEach(function(t){var o=a.show_media&&t.full_picture||t.message;null!==t.from&&o&&(a.messagedPosts++,e?t.admin_creator&&(a.adminPostsNumber++,new u("facebook",l.facebook.utility.unifyPostData(t)).render()):new u("facebook",l.facebook.utility.unifyPostData(t)).render())})},unifyPostData:function(t){var e={},o=t.message?t.message:t.story;if(e.id=t.id,e.dt_create=l.getTimeAgo(t.created_time,"fb"),e.author_link="http://facebook.com/"+t.from.id,e.author_picture=l.facebook.graph+t.from.id+"/picture",e.readMore=a.readMore,e.author_name=t.from.name,e.name=t.name||"",e.message=o||"",e.description=t.description?t.description:"",e.link=t.link?t.link:"http://facebook.com/"+t.id,!0===a.show_media&&t.full_picture){var n=l.facebook.utility.prepareAttachment(t);n&&(e.attachment=n)}return e}}}};return this.each(function(){l.init(),a.update_period&&setInterval(function(){return l.init()},a.update_period)})}}(jQuery);